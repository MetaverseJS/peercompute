self.onmessage=async e=>{const t=e.data;if(!t||"run"!==t.type)return;const{id:r,data:s,fn:n,module:o,exportName:a}=t;try{let e;if(n?e=new Function(`return (${n});`)():o&&(e=(await import(o))[a||"default"]),"function"!=typeof e)throw new Error("Handler not found for task");const t=await e(s);self.postMessage({type:"result",id:r,result:t})}catch(e){self.postMessage({type:"error",id:r,error:e?.message||String(e)})}};